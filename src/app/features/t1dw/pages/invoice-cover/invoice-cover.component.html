<div class="container">
  <div class="row">
    <div class="col-md-12">
      <h3>Informações Gerais</h3>
    </div>
  </div>
  {{ params | json }}
  <hr class="no-margin-t" />
  <form
    bfmForm
    (ngSubmit)="onSubmit()"
    novalidate
    [resetErrors]="resetErrors"
    #f="ngForm"
    [validations]="validations"
  >
    <div class="form-row-space-between">
      <div class="form-group" style="width: 100%">
        <app-autocomplete
          id="cod_estab"
          name="cod_estab"
          bfmField
          bfmLabel="Estabelecimento"
          inputLabelText="Estabelecimento"
          model-field="codEstab"
          label-field="label"
          [(ngModel)]="coverData.id.codEstab"
          [columns]="estabColumns"
          [blockSize]="25"
          [debounceTime]="1000"
          [headerTranslation]="estabHeaderTranslation"
          [searchCallback]="loadEstabelecimentos"
          [disabled]="
            params.operation !== 'new' || isEstablishmentAlreadyDefined
          "
          [required]="true"
        >
        </app-autocomplete>
      </div>
    </div>
    <div class="form-row-space-between">
      <div class="form-group">
        <app-date-picker
          id="data_fiscal"
          name="data_fiscal"
          inputLabelText="Data Fiscal"
          buttonLabel="Abrir calendário"
          [(ngModel)]="coverData.id.dataFiscal"
          [disabled]="true"
        ></app-date-picker>
      </div>
      <div class="form-group">
        <app-date-picker
          id="data_emissao"
          name="data_emissao"
          bfmLabel="Data de Emissão"
          inputLabelText="Data de Emissão"
          buttonLabel="Abrir calendário"
          [(ngModel)]="coverData.dataEmissao"
          [disabled]="params.operation !== 'new'"
          [required]="true"
        ></app-date-picker>
      </div>
      <div class="form-group">
        <app-input-number
          id="hora_emissao"
          name="hora_emissao"
          inputLabelText="Hora Emissão"
          [(ngModel)]="coverData.horaEmissao"
          [min]="0"
          [max]="24"
          [disabled]="params.operation !== 'new'"
          [required]="false"
        ></app-input-number>
      </div>
      <div class="form-group">
        <app-date-picker
          id="data-saida-rec"
          name="data-saida-rec"
          bfmField
          bfmLabel="Data Entrada/Saida"
          inputLabelText="Data Entrada/Saida"
          [required]="true"
          buttonLabel="Abrir calendário"
          [(ngModel)]="coverData.dataSaidaRec"
          [disabled]="params.operation !== 'new'"
          (ngModelChange)="onChangeDataFiscal()"
        ></app-date-picker>
      </div>
      <div class="form-group">
        <app-input-number
          id="hora-saida-rec"
          name="hora-saida-rec"
          bfmLabel="Hora E/S"
          inputLabelText="Hora Entrada/Saída"
          [(ngModel)]="coverData.horaSaidaRec"
          [min]="0"
          [max]="24"
          [disabled]="params.operation !== 'new'"
          [required]="false"
        ></app-input-number>
      </div>
      <div class="form-group">
        <app-date-picker
          id="dt-extemp"
          name="dt-extemp"
          inputLabelText="Dt. Extemp"
          buttonLabel="Abrir calendário"
          [(ngModel)]="coverData.datEscrExtemp"
          [disabled]="params.operation !== 'new'"
          [required]="false"
        ></app-date-picker>
      </div>
    </div>
    <div class="form-row-space-between">
      <div class="form-group">
        <app-select
          id="e-s"
          name="e-s"
          inputLabelText="E/S"
          [items]="movtoESItems"
          [(ngModel)]="coverData.id.movtoES"
          [required]="true"
          [disabled]="params.operation !== 'new'"
        ></app-select>
      </div>
      <div class="form-group">
        <app-select
          id="norm-dev"
          name="norm-dev"
          inputLabelText="N/D"
          [required]="true"
          [items]="normDevItems"
          [(ngModel)]="coverData.id.normDev"
          [disabled]="params.operation !== 'new'"
        ></app-select>
      </div>
      <div class="form-group">
        <app-checkbox
          id="ind-nf-venda-terceiros"
          name="ind-nf-venda-terceiros"
          inputLabelText="Nota Fiscal de venda emitida por terceiro"
          [(ngModel)]="coverData.indNfVendaTerceiros"
        ></app-checkbox>
      </div>
    </div>
    <div class="form-flex">
      <div
        class="form-flex"
        style="width: 360px; column-gap: 5px; flex-wrap: nowrap"
      >
        <div class="form-group">
          <app-input-text
            id="num-docFis"
            name="num-docFis"
            inputLabelText="Número NF"
            [(ngModel)]="coverData.id.numDocfis"
            width="150px"
            [maxlength]="12"
            [required]="true"
            [disabled]="params.operation !== 'new'"
          >
          </app-input-text>
        </div>
        <div class="form-group">
          <app-input-text
            id="serie-docfis"
            name="serie-docfis"
            bfmLabel="Serie NF"
            inputLabelText="&nbsp;"
            [(ngModel)]="coverData.id.serieDocfis"
            width="100px"
            [maxlength]="3"
            [required]="true"
          >
          </app-input-text>
        </div>
        <div class="form-group">
          <app-input-text
            id="sub-serie-docfis"
            name="sub-serie-docfis"
            inputLabelText="&nbsp;"
            [(ngModel)]="coverData.id.subSerieDocfis"
            width="100px"
            [maxlength]="2"
            [disabled]="params.operation !== 'new'"
          >
          </app-input-text>
        </div>
      </div>
      <div class="form-group" style="flex-grow: 1">
        <app-autocomplete
          id="cod-docto"
          name="cod-docto"
          [required]="true"
          inputLabelText="Tipo de Documento"
          [(ngModel)]="coverData.id.codDocto"
          [columns]="defaultColumns"
          model-field="codigo"
          label-field="label"
          [blockSize]="25"
          [debounceTime]="1000"
          [minSearchCharacterCount]="2"
          [headerTranslation]="defaultHeaderTranslation"
          [searchCallback]="loadTipoDocumento"
          [disabled]="
            params.operation !== 'new' ||
            !coverData.id.codEstab ||
            !coverData.id.dataFiscal
          "
        >
        </app-autocomplete>
      </div>
    </div>
    <div class="form-flex" *ngIf="isServiceInvoice() || isMixedInvoice()">
      <div class="form-group" style="width: 100%">
        <app-input-text
          id="num_docfis_serv"
          name="num_docfis_serv"
          inputLabelText="Número NF (60 posições)"
          [(ngModel)]="coverData.numDocfisServ"
          width="100%"
          [maxlength]="60"
          [disabled]="isNumDocfisServEnabled"
        >
        </app-input-text>
      </div>
    </div>
    <div class="form-row-space-between">
      <div class="form-flex" style="flex-direction: column; width: 15%">
        <label for="ind_fis_jur" class="bento-label-required">Fis/Jur</label>
        <div class="flex-row-compose input-group">
          <app-modal
            title="Pessoa Física / Jurídica"
            size="xl"
            [startLoading]="true"
            [gridColumnsData]="pessoaFisJurModalGrid"
            [search]="pessoaFisJurModalSearch"
            (closeSelectedItem)="pessoaFisJurSelected($event)"
            [disabled]="
              params.operation !== 'new' ||
              !coverData.id.codEstab ||
              !coverData.id.dataFiscal
            "
          ></app-modal>
          <div style="width: 100%">
            <app-select
              id="ind-fis-jur"
              name="ind-fis-jur"
              bfmField
              bfmLabel="N/D"
              [required]="true"
              [items]="naturalLegalIndicators"
              [(ngModel)]="coverData.id.indFisJur"
              [disabled]="
                params.operation !== 'new' ||
                !coverData.id.codEstab ||
                !coverData.id.dataFiscal
              "
              (ngModelChange)="
                coverData.id.codFisJur = undefined;
                coverData.razaoSocialFisJur = undefined
              "
            ></app-select>
          </div>
        </div>
      </div>
      <div class="form-group" style="width: 15%">
        <app-input-text
          id="cod_fis_jur"
          name="cod_fis_jur"
          bfmLabel="Código Fis/Jur"
          inputLabelText="&nbsp;"
          [(ngModel)]="coverData.id.codFisJur"
          [required]="true"
          [maxlength]="14"
          (blur)="findFisJur()"
          [disabled]="
            params.operation !== 'new' ||
            !coverData.id.codEstab ||
            !coverData.id.dataFiscal
          "
        >
        </app-input-text>
      </div>
      <div class="form-group" style="width: 48%">
        <app-input-text
          id="razao_social_fis_jur"
          name="razao_social_fis_jur"
          inputLabelText="&nbsp;"
          [(ngModel)]="coverData.razaoSocialFisJur"
          [disabled]="true"
        >
        </app-input-text>
      </div>
      <div class="form-group" style="width: 20%">
        <app-input-text
          id="fis_jur_cpf_cnpj"
          name="fis_jur_cpf_cnpj"
          inputLabelText="CPF/CNPJ"
          [(ngModel)]="coverData.fisJurCpfCnpj"
          [maxlength]="14"
          [disabled]="true"
        >
        </app-input-text>
      </div>
    </div>
    <div class="form-row-space-between">
      <div class="form-group" style="flex-grow: 0.75">
        <app-autocomplete
          id="cod-modelo"
          name="cod-modelo"
          [required]="true"
          inputLabelText="Modelo Doc."
          [(ngModel)]="coverData.codModelo"
          [columns]="defaultColumns"
          model-field="codigo"
          label-field="label"
          [blockSize]="25"
          [debounceTime]="1000"
          [minSearchCharacterCount]="2"
          [headerTranslation]="defaultHeaderTranslation"
          [searchCallback]="loadModeloDocumento"
          [disabled]="isDisabled()"
        >
        </app-autocomplete>
      </div>
      <div class="form-group" style="flex-grow: 0.25">
        <app-autocomplete
          id="cod-Trib-int"
          name="cod-Trib-int"
          [required]="true"
          inputLabelText="Trib. Interna"
          [(ngModel)]="coverData.codTribInt"
          [columns]="defaultColumns"
          model-field="codigo"
          label-field="label"
          [blockSize]="25"
          [debounceTime]="1000"
          [minSearchCharacterCount]="2"
          [headerTranslation]="defaultHeaderTranslation"
          [searchCallback]="loadTributacaoInterna"
        >
        </app-autocomplete>
      </div>
    </div>
    <div class="form-row-space-between">
      <app-select
        id="modelo-nf-dm"
        name="modelo-nf-dm"
        inputLabelText="Código Modelo NF"
        [items]="modeloNfDmItems"
        [(ngModel)]="coverData.codModeloCotepe"
        [disabled]="isDisabled()"
      ></app-select>
    </div>
    <div class="form-flex">
      <app-select
        id="cod-class-doc-fis"
        name="cod-class-doc-fis"
        inputLabelText="Clas. Doc. Fiscal"
        [items]="codClassDocFisItems"
        [(ngModel)]="coverData.codClassDocFis"
        [disabled]="isDisabled()"
      ></app-select>
      <app-checkbox
        id="situacao"
        name="situacao"
        inputLabelText="Sit. Cancelado"
        [(ngModel)]="coverData.situacao"
      ></app-checkbox>
      <app-date-picker
        id="dat-autentic"
        name="dat-autentic"
        bfmField
        bfmLabel="Data Autent./Cancel"
        inputLabelText="Data Autent./Cancel"
        [required]="true"
        buttonLabel="Abrir calendário"
        [(ngModel)]="coverData.datAutentic"
        [disabled]="isDisabled()"
      ></app-date-picker>
    </div>
  </form>
</div>
{{ coverData | json }}
